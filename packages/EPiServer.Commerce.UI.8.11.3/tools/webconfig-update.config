<?xml version="1.0"?>
<configuration xmlns:xdt="http://schemas.microsoft.com/XML-Document-Transform">
  <episerver.shell>
    <protectedModules>
      <!-- Remove and re-add Commerce module to remove any path attributes -->
      <add name="Commerce" xdt:Transform="Remove" xdt:Locator="Match(name)" />
      <add name="Commerce" xdt:Transform="Insert">
        <assemblies>
          <add assembly="EPiServer.Business.Commerce" />
          <add assembly="EPiServer.Commerce.UI" />
        </assemblies>
      </add>
      <!-- Remove old addon module, make sure new module is in place-->
      <add name="EPiServer.Commerce.AddOns.UI" xdt:Transform="Remove" xdt:Locator="Match(name)"/>
      <add name="EPiServer.Commerce.Shell" xdt:Transform="Remove" xdt:Locator="Match(name)"/>
      <add name="EPiServer.Commerce.Shell" resourcePath="{rootpath}/Commerce/Shell" xdt:Transform="Insert" />
    </protectedModules>
  </episerver.shell>
  <system.webServer>
    <modules>
      <add name="MigrationInitializationModule" xdt:Transform="Remove" xdt:Locator="Match(name)"/>
      <add name="MigrationInitializationModule" type="EPiServer.Commerce.Internal.Migration.MigrationInitializationModule, EPiServer.Commerce.Internal.Migration" preCondition="managedHandler" xdt:Transform="Insert"/>
    </modules>
  </system.webServer>
  <episerver.framework xmlns:xdt="http://schemas.microsoft.com/XML-Document-Transform">
    <!-- Remove Commerce VPP -->
    <virtualPathProviders>
      <add name="EPiServerCommerce" xdt:Transform="Remove" xdt:Locator="Match(name)"/>
    </virtualPathProviders>
  </episerver.framework>
</configuration>